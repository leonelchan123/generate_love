<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Meter - Medidor de Amor</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }

        .love-card {
            width: 480px;
            height: 270px;
            background: radial-gradient(circle at center, #ff69b4, #ff1493);
            border-radius: 0px;
            position: relative;
            overflow: hidden;
            box-shadow: none;
            border: none;
        }

        .polka-dots {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, rgba(255,255,255,0.7) 2px, transparent 2px);
            background-size: 20px 20px;     
        }

        .profile-circle {
            position: absolute;
            width: 160px;
            height: 160px;
            background: white;
            border-radius: 15px;
            border: 8px solid #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .left-profile {
            top: 15px;
            left: 15px;
        }

        .right-profile {
            top: 15px;
            right: 15px;
        }

        .profile-text {
            position: absolute;
            font-size: 15px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            text-align: center;
            width: 160px;
            font-family: Arial, sans-serif;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .left-text {
            top: 200px;
            left: 15px;
        }

        .right-text {
            top: 200px;
            right: 15px;
        }

        .heart-container {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 35px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .percentage {
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 34px;
            font-weight: bold;
            color: white;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            font-family: 'Arial Black', Arial, sans-serif;
        }

        .percentage-message {
            position: absolute;
            bottom: 15px;
            left: 20px;
            right: 20px;
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
            text-align: center;
            font-family: Arial, sans-serif;
            word-wrap: break-word;
        }

        .custom-text {
            position: absolute;
            bottom: 2%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
            text-align: center;
            font-family: Arial, sans-serif;
            max-width: 85%;
            word-wrap: break-word;
            line-height: 1.1;
        }

        .decorative-hearts {
            position: absolute;
            color: rgba(255,255,255,0.6);
            font-size: 20px;
        }

        .heart1 {
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
        }

        .heart2 {
            bottom: 40px;
            left: 30px;
        }

        .heart3 {
            bottom: 40px;
            right: 30px;
        }

        .heart4 {
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            font-size: 16px;
        }

        .heart5 {
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="love-card">
        <div class="polka-dots"></div>
        
        <!-- Mensaje personalizado seg√∫n el porcentaje -->
        <div class="percentage-message" id="percentageMessage">üíï CALCULANDO...</div>
        
        <!-- Porcentaje arriba del coraz√≥n -->
        <div class="percentage" id="percentage">0%</div>
        
        <!-- C√≠rculos blancos para las fotos de perfil -->
        <div class="profile-circle left-profile" id="leftProfile"></div>
        <div class="profile-circle right-profile" id="rightProfile"></div>
        
        <!-- Textos de los perfiles -->
        <div class="profile-text left-text" id="leftText">Usuario 1</div>
        <div class="profile-text right-text" id="rightText">Usuario 2</div>
        
        <!-- Coraz√≥n central -->
        <div class="heart-container">üíñ</div>
        
        <!-- Texto personalizable abajo (autor) -->
        <div class="custom-text" id="authorText">Bot-Esponja</div>
        
        <!-- Corazones decorativos -->
        <div class="decorative-hearts heart1">üíï</div>
        <div class="decorative-hearts heart2">üíù</div>
        <div class="decorative-hearts heart3">üíï</div>
        <div class="decorative-hearts heart4">üíñ</div>
        <div class="decorative-hearts heart5">üíñ</div>
    </div>

    <script>
        // Funci√≥n para obtener el mensaje seg√∫n el porcentaje
        function getPercentageMessage(percentage) {
            if (percentage >= 90) return "üíñ ¬°AMOR ETERNO!";
            if (percentage >= 80) return "üíï ¬°S√öPER COMPATIBLES!";
            if (percentage >= 70) return "üíò ¬°MUY BUENA CONEXI√ìN!";
            if (percentage >= 60) return "üíì BUENA COMPATIBILIDAD";
            if (percentage >= 50) return "üíü COMPATIBILIDAD PROMEDIO";
            if (percentage >= 40) return "üíî MEJOR COMO AMIGOS";
            if (percentage >= 30) return "üòÖ SOLO AMIGOS";
            if (percentage >= 20) return "üò¨ MEJOR COMO CONOCIDOS";
            if (percentage >= 10) return "üòê POCA CONEXI√ìN";
            return "üòÇ ¬°CERO QU√çMICA!";
        }

        // Funci√≥n para truncar nombres largos
        function truncateName(name, maxLength = 15) {
            if (name.length <= maxLength) return name;
            return name.substring(0, maxLength - 3) + '...';
        }

        // Funci√≥n para actualizar la imagen con datos din√°micos
        function updateLoveMeter(data) {
            // Actualizar porcentaje
            document.getElementById('percentage').textContent = data.percentage + '%';
            
            // Actualizar mensaje seg√∫n porcentaje
            document.getElementById('percentageMessage').textContent = getPercentageMessage(data.percentage);
            
            // Actualizar nombres (truncados si son muy largos)
            document.getElementById('leftText').textContent = truncateName(data.senderName);
            document.getElementById('rightText').textContent = truncateName(data.targetName);
            
            // Actualizar im√°genes de perfil con fallback mejorado
            const leftProfile = document.getElementById('leftProfile');
            const rightProfile = document.getElementById('rightProfile');
            
            if (data.senderImage) {
                leftProfile.style.backgroundImage = `url('${data.senderImage}')`;
                leftProfile.style.backgroundSize = 'cover';
                leftProfile.style.backgroundPosition = 'center';
                leftProfile.style.backgroundRepeat = 'no-repeat';
                leftProfile.style.backgroundColor = 'white';
                leftProfile.innerHTML = '';
            } else {
                // Fallback para imagen por defecto - usar profile_icon.png
                leftProfile.style.backgroundImage = 'url("./media/menus/profile_icon.png")';
                leftProfile.style.backgroundSize = 'cover';
                leftProfile.style.backgroundPosition = 'center';
                leftProfile.style.backgroundRepeat = 'no-repeat';
                leftProfile.style.backgroundColor = 'white';
                leftProfile.innerHTML = '';
            }
            
            if (data.targetImage) {
                rightProfile.style.backgroundImage = `url('${data.targetImage}')`;
                rightProfile.style.backgroundSize = 'cover';
                rightProfile.style.backgroundPosition = 'center';
                rightProfile.style.backgroundRepeat = 'no-repeat';
                rightProfile.style.backgroundColor = 'white';
                rightProfile.innerHTML = '';
            } else {
                // Fallback para imagen por defecto - usar profile_icon.png
                rightProfile.style.backgroundImage = 'url("./media/menus/profile_icon.png")';
                rightProfile.style.backgroundSize = 'cover';
                rightProfile.style.backgroundPosition = 'center';
                rightProfile.style.backgroundRepeat = 'no-repeat';
                rightProfile.style.backgroundColor = 'white';
                rightProfile.innerHTML = '';
            }
            
            // Actualizar autor
            if (data.author) {
                document.getElementById('authorText').textContent = data.author;
            }
        }

        // Funci√≥n para generar porcentaje determin√≠stico
        function generateLovePercentage(sender, target) {
            const combined = sender + target;
            let hash = 0;
            for (let i = 0; i < combined.length; i++) {
                const char = combined.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32bit integer
            }
            return Math.abs(hash) % 101; // 0-100
        }

        // Ejemplo de uso (esto se llamar√≠a desde el bot)
        function initializeLoveMeter(senderNumber, targetNumber, senderName, targetName, senderImage, targetImage, author) {
            const percentage = generateLovePercentage(senderNumber, targetNumber);
            
            const data = {
                percentage: percentage,
                senderName: senderName || senderNumber,
                targetName: targetName || targetNumber,
                senderImage: senderImage,
                targetImage: targetImage,
                author: author || 'Bot-Esponja'
            };
            
            updateLoveMeter(data);
            return data;
        }

        // Para testing
        // initializeLoveMeter('123456789', '987654321', 'Juan P√©rez', 'Mar√≠a Garc√≠a', null, null, 'Bot-Esponja');
    </script>
</body>
</html>